{% extends "HuoBundle:Global:base-index.html.twig" %}

{% block stylesheets %}
    {{ parent() }}
    <link href="{{ asset('bundles/public/login/css/login-soft.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset('bundles/public/login/css/components.css') }}" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/public/login/js/jquery.backstretch.min.js') }}" type="text/javascript"></script>
    <script>
        $(function(){
            $.backstretch([
                    "http://wx-image.joywell.com.cn/pss/1.jpg",
                    "http://wx-image.joywell.com.cn/pss/2.jpg",
                    "http://wx-image.joywell.com.cn/pss/3.jpg",
                    "http://wx-image.joywell.com.cn/pss/4.jpg"
                ], {
                    fade: 1000,
                    duration: 8000
                }
            );

            $('#login').click(function(){
                if (!$('#username').val() || !$('#password').val()) {
                    $('.alert').fadeIn();
                }else{
                    $('#login-submit').click();
                }
            });

            $('.close').click(function(){
                $('.alert').fadeOut();
            })
            {% if error %}
                {% if error.message == 'User account is disabled.' %}
                var errorMsg = '当前用户被禁用！请联系管理员。';
                {% elseif error.message == 'Bad credentials.' %}
                var errorMsg = '当前用户的用户名或密码错误！';
                {% else %}
                var errorMsg = '{{ error.message }}';
                {% endif %}
            $('.alert').fadeIn().find('span').html(errorMsg);
            {% endif %}
        });
    </script>
{% endblock %}

{% block body %}
<body class="login">
    <div class="logo">
        <img src="http://wx-image.joywell.com.cn/joywell_300_75.png" style="margin:30px 0px 20px;" />
    </div>
    <div class="content">
        <form action="{{ path('loginCheck') }}" method="post" class="login-form">
            <h3 class="form-title">货架用户登录</h3>
            <div class="alert alert-danger display-hide">
                <button type="button" class="close" data-close="alert"></button>
                <span>请输入您的用户名和密码</span>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">用户名</label>
                <div class="input-icon">
                    <i class="icon-user"></i>
                    <input id="username" class="form-control placeholder-no-fix" type="text" autocomplete="off" placeholder="用户名" name="_username" />
                </div>
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9">密码</label>
                <div class="input-icon">
                    <i class="icon-lock"></i>
                    <input id="password" class="form-control placeholder-no-fix" type="password" autocomplete="off" placeholder="密码" name="_password" />
                </div>
            </div>
            <div class="form-actions">
                <button type="button" id="login" class="btn blue pull-right">
                    登录 <i class="icon-arrow-right"></i>
                </button>
                <button type="submit" id="login-submit" style="display:none;"></button>
            </div>
        </form>
    </div>
    <div class="copyright">
        {% include "HuoBundle:Footer:loginFooter.html.twig" %}
    </div>
</body>
{% endblock %}
